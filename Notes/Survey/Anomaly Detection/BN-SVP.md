<h2>1. Abstract</h2>
BN-SVP essentially performs dynamic non-parametric hierarchical clustering with an enhanced self-transition that groups segments in a video into temporally consistent and semantically coherent hidden states that can be naturally interpreted as scenes. Each segment is assumed to be generated through a nonparametric mixture process that allows variations of segments within the same scenes to accommodate the dynamic and noisy nature of many real-world surveillance videos. The scene and mixture component assignment of BN-SVP also induces a pairwise similarity among segments, resulting in non-parametric construction of a submodular set function. Integrating this function with an MIL loss effectively exposes the model to a diverse set of potentially positive instances to improve its training. A greedy algorithm is developed to optimize the submodular function and support efficient model training.
<h2>2. Methodology</h2>
<h3>2.1 Bayesian non-parametric submodular set function construction</h3>
Consider a collection of hidden states (scenes in a video), the transition probability of state $j$ to other states is governed by a DP: $\mathcal{G}_j = \sum_{l = 1}^{\infty}\hat{\pi}_{jl}\delta_{\hat{\phi}jl}, \hat{\pi}_j \sim GEM(\alpha)$, where $GEM(\alpha)$ is formed through a stick breaking construction process with parameter $\alpha$, $\hat{\phi}_{jl}$ is drawn from a base distribution $\mathcal{G}_0$ which is follows another DP: $\mathcal{G}_0 = \sum_{k = 1}^\infty \beta_k\delta_{\phi k}, \beta \sim GEM(\gamma), \phi_k ~ H$. Considering unique set of atoms $\phi_k$, rewrite: $\mathcal{G}_j = \sum_{k = 1}^\infty \pi_{jk}\delta_{\phi_k}, \pi_j \sim DP(\alpha, \beta), \phi_k \sim H$. The transition probability of $j$'s state is augmented by: $\pi_j \sim DP(\alpha + \mathcal{p}, \frac{\alpha\beta + \mathcal{p}\delta_j}{\alpha + \mathcal{p}})$. To allow certain levels of variations within the same scene and accommodate the highly dynamic nature of a video sequence, propose to model the emission process using a mixture distribution governed by another non-parametric DP. The scene and component assignments of BN-SVP induces a pairwise similarity among segments in a videos: $S_{i, j} = (x^+_i)^T\sum_{z_i, s_i}^{-1}x^+_j$ if $s_i == s_j \wedge z_i == z_j$, else $S_{i, j} = 0$. Given BN-SVP induced pairwise similarity, the following function is a submodular set fuction: $F(C) = \sum_{i \in \mathcal{B}_{pos}}max_{j \in C}S_{i, j}$. By further integrating margin loss, a submodularity diversified MIL loss is defined: $min_{w, C^+ \in \mathcal{B}_{pos}, |C^+| \leq \mathcal{k}}L(C^+) - \lambda F(C^+)$, where $L(C^+) = [1 - \frac{1}{|C^+|}\sum_{i \in C^+}f(x^+_i) + max_{j \in \mathcal{B}_{neg}}f(x^-_j)]_+$.
<h3>2.2 Greedy submodular function optimization</h3>
Let $f^*_s$ denote maximum score among all segments assigned to same mixture component and $i^*_s$ be index of corresponding representative segment: $i^*_s = argmax_{\forall i: s_i = s}f(x^+_i), f^*_s = f(x^+_{i^*_s})$. Let $\hat{C}^+ = \phi$ and for mixture component $s$, $\hat{C}^+ \leftarrow \hat{C}^+ \cup \{i^*_s\}$ if $f^*_s \geq \epsilon$ else $\hat{C}^+ \leftarrow \hat{C}^+$. Once a representative set $\hat{C}^+$ is constructed, model training can proceed by solving the following MIL loss: $min_w[1 - \frac{1}{|\hat{C}^+|}\sum_{i \in \hat{C}^+}f(x^+_i) + max_{j \in \mathcal{B}_{neg}}f(x^-_j)]_+$.
<h2>3. Datasets</h2>
Shanghaitech, Aveue and UCF-Crime.
<h2>4. Metrics</h2>
AUC.
<h2>5. Code</h2>
https://github.com/ritmininglab/bn-svp.